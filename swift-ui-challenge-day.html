
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="index, follow" />

  <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,400;0,700;1,400&family=Source+Sans+Pro:ital,wght@0,300;0,400;0,700;1,400&display=swap" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="/theme/stylesheet/style.min.css">


    <link id="pygments-light-theme" rel="stylesheet" type="text/css"
          href="/theme/pygments/github.min.css">



  <link rel="stylesheet" type="text/css" href="/theme/font-awesome/css/fontawesome.css">
  <link rel="stylesheet" type="text/css" href="/theme/font-awesome/css/brands.css">
  <link rel="stylesheet" type="text/css" href="/theme/font-awesome/css/solid.css">



  <!-- Chrome, Firefox OS and Opera -->
  <meta name="theme-color" content="#333">
  <!-- Windows Phone -->
  <meta name="msapplication-navbutton-color" content="#333">
  <!-- iOS Safari -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <!-- Microsoft EDGE -->
  <meta name="msapplication-TileColor" content="#333">




 

<meta name="author" content="alex" />
<meta name="description" content="Fun day today with 100 Days of SwiftUI. The core challenge was very easy, a simpler version of the PaperWeight app I&#39;ve been making with Nicholas. However, after completing the basic challenge I decided to try using Measurement class to do my conversions. It worked fine, and made for a …" />
<meta name="keywords" content="swift, swiftui">


  <meta property="og:site_name" content="Alex's Blog"/>
  <meta property="og:title" content="Swift UI Challenge Day"/>
  <meta property="og:description" content="Fun day today with 100 Days of SwiftUI. The core challenge was very easy, a simpler version of the PaperWeight app I&#39;ve been making with Nicholas. However, after completing the basic challenge I decided to try using Measurement class to do my conversions. It worked fine, and made for a …"/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:url" content="/swift-ui-challenge-day.html"/>
  <meta property="og:type" content="article"/>
  <meta property="article:published_time" content="2021-06-21 12:55:00-07:00"/>
  <meta property="article:modified_time" content=""/>
  <meta property="article:author" content="/author/alex.html">
  <meta property="article:section" content="swift"/>
  <meta property="article:tag" content="swift"/>
  <meta property="article:tag" content="swiftui"/>
  <meta property="og:image" content="/images/alex_pixel_avatar.jpg">

  <title>Alex's Blog &ndash; Swift UI Challenge Day</title>


</head>
<body class="light-theme">

<aside>
  <div>
    <a href="/">
      <img src="/images/alex_pixel_avatar.jpg" alt="Alex" title="Alex">
    </a>

    <h1>
      <a href="/">Alex</a>
    </h1>

    <p>Machine Learning, Art, and other stuff</p>


    <nav>
      <ul class="list">



          <li>
            <a target="_self" href="https://www.inaturalist.org/users/alexshepard" >inat</a>
          </li>
      </ul>
    </nav>

    <ul class="social">
      <li>
        <a class="sc-github"
           href="https://github.com/alexshepard/"
           target="_blank">
          <i class="fa-brands fa-github"></i>
        </a>
      </li>
    </ul>
  </div>

</aside>
  <main>

<nav>
  <a href="/">Home</a>

  <a href="/archives.html">Archives</a>
  <a href="/categories.html">Categories</a>
  <a href="/tags.html">Tags</a>


</nav>

<article class="single">
  <header>
      
    <h1 id="swift-ui-challenge-day">Swift UI Challenge Day</h1>
    <p>
      Posted on Mon 21 June 2021 in <a href="/category/swift.html">swift</a>

    </p>
  </header>


  <div>
    <p>Fun day today with <a href="https://www.hackingwithswift.com/100/swiftui">100 Days of SwiftUI</a>. The core challenge was very easy, a simpler version of the <a href="https://apps.apple.com/app/apple-store/id1521170681?mt=8">PaperWeight app</a> I've been making with Nicholas.</p>
<p>However, after completing the basic challenge I decided to try using <code>Measurement</code> class to do my conversions. It worked fine, and made for a shorter and probably better solution. However, I tried using the iOS 15 <code>.formatted()</code> method on the converted measurement and while changes to the input length or input units flowed through the state system and triggered an update in the output, changes to the output format didn't seem to affect the computed output, even though the outputUnits was labelled with the <code>@State</code> property wrapper. Maybe the formatter is caching something?</p>
<p>Here's some code to illustrate:</p>
<div class="highlight"><pre><span></span><code><span class="kd">struct</span> <span class="nc">ContentView</span><span class="p">:</span> <span class="n">View</span> <span class="p">{</span>
    <span class="p">@</span><span class="n">State</span> <span class="kd">private</span> <span class="kd">var</span> <span class="nv">inputText</span> <span class="p">=</span> <span class="s">&quot;&quot;</span>
    <span class="p">@</span><span class="n">State</span> <span class="kd">private</span> <span class="kd">var</span> <span class="nv">inputUnits</span> <span class="p">=</span> <span class="mi">0</span>
    <span class="p">@</span><span class="n">State</span> <span class="kd">private</span> <span class="kd">var</span> <span class="nv">outputUnits</span> <span class="p">=</span> <span class="mi">4</span>

    <span class="kd">private</span> <span class="kd">var</span> <span class="nv">appleUnits</span> <span class="p">=</span> <span class="p">[</span>
        <span class="n">UnitLength</span><span class="p">.</span><span class="n">meters</span><span class="p">,</span>
        <span class="n">UnitLength</span><span class="p">.</span><span class="n">kilometers</span><span class="p">,</span>
        <span class="n">UnitLength</span><span class="p">.</span><span class="n">feet</span><span class="p">,</span>
        <span class="n">UnitLength</span><span class="p">.</span><span class="n">yards</span><span class="p">,</span>
        <span class="n">UnitLength</span><span class="p">.</span><span class="n">miles</span><span class="p">,</span>
    <span class="p">]</span>

    <span class="kd">private</span> <span class="kd">var</span> <span class="nv">outputConverted</span><span class="p">:</span> <span class="n">Measurement</span><span class="p">&lt;</span><span class="n">UnitLength</span><span class="p">&gt;</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="nv">numericInput</span><span class="p">:</span> <span class="nb">Double</span> <span class="p">=</span> <span class="nb">Double</span><span class="p">(</span><span class="n">inputText</span><span class="p">)</span> <span class="p">??</span> <span class="mf">0.0</span>

        <span class="kd">let</span> <span class="nv">inputLength</span> <span class="p">=</span> <span class="n">Measurement</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="n">numericInput</span><span class="p">,</span> <span class="n">unit</span><span class="p">:</span> <span class="n">appleUnits</span><span class="p">[</span><span class="n">inputUnits</span><span class="p">])</span>
        <span class="kd">let</span> <span class="nv">outputLength</span> <span class="p">=</span> <span class="n">inputLength</span><span class="p">.</span><span class="n">converted</span><span class="p">(</span><span class="n">to</span><span class="p">:</span> <span class="n">appleUnits</span><span class="p">[</span><span class="n">outputUnits</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">outputLength</span>
    <span class="p">}</span>

    <span class="p">...</span>


    <span class="kd">var</span> <span class="nv">body</span><span class="p">:</span> <span class="n">some</span> <span class="n">View</span> <span class="p">{</span>
        <span class="p">...</span>

        <span class="k">if</span> <span class="cp">#available</span><span class="p">(</span><span class="cp">iOS</span> <span class="mf">15.0</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">Text</span><span class="p">(</span><span class="s">&quot;</span><span class="si">\(</span><span class="n">outputConverted</span><span class="p">.</span><span class="n">formatted</span><span class="si">())</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p>In this case, at least with Beta 1 of Xcode, changing the value in <code>inputUnits</code> triggers a full recalculation of the computed variable <code>outputConverted</code> and updates the UI. Changing the value in <code>outputUnits</code> does trigger a recalculation of <code>outputConverted</code> (I can see this with a breakpoint or print), but it doesn't update the UI.</p>
<p>Another day, another challenge with the beta apis for <code>FormatStyle</code>, I guess?</p>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="/tag/swift.html">swift</a>
      <a href="/tag/swiftui.html">swiftui</a>
    </p>
  </div>






</article>

<footer>
<p>&copy; 2024 </p>
<p>
Built with <a href="http://getpelican.com" target="_blank">Pelican</a> using <a href="http://bit.ly/flex-pelican" target="_blank">Flex</a> theme
</p></footer>  </main>

<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Alex's Blog ",
  "url" : "",
  "image": "/images/alex_pixel_avatar.jpg",
  "description": ""
}
</script>
</body>
</html>