<!DOCTYPE html>
<html lang="en">
<head>
        <title>Alex's Blog : Closures, part 2</title>
        <meta charset="utf-8" />
        <link rel="stylesheet" href="https://alexshepard.github.io/theme/css/main.css" type="text/css" />
        <link href="https://alexshepard.github.io/None" type="application/atom+xml" rel="alternate" title="Alex's Blog ATOM Feed" />

        <!--[if IE]>
                <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

        <!--[if lte IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="https://alexshepard.github.io/css/ie.css"/>
                <script src="https://alexshepard.github.io/js/IE8.js" type="text/javascript"></script><![endif]-->

        <!--[if lt IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="https://alexshepard.github.io/css/ie6.css"/><![endif]-->

</head>

<body>
        
<header>
    <h1><a href="https://alexshepard.github.io" id="site-title">Alex's Blog </a> :
        <a href="https://alexshepard.github.io/closures-part-2.html" id="page-title">Closures, part 2</a></h1>
<time datetime="2020-02-15T17:14:15-08:00">Sat 15 February 2020</time></header>
<article>
    <p>Another day of <a href="https://www.hackingwithswift.com/100">100 Days of Swift</a>, with more closure confusion this time. Closure syntax is complicated on its own, without even considering all of the shorthand and optional syntactic structures, from trailing closure syntax. The confusion is compounded by the way that the Xcode editor will suggest some shorthand but not others.</p>
<p>This example is stupid and contrived, but whatever.</p>
<p>Given these functions:</p>
<div class="highlight"><pre><span></span><code><span class="kd">func</span> <span class="nf">cgContextWatermark</span><span class="p">(</span><span class="n">image</span><span class="p">:</span> <span class="bp">UIImage</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">String</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="bp">UIImage</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nv">cgImage</span> <span class="p">=</span> <span class="n">image</span><span class="p">.</span><span class="n">cgImage</span>
    <span class="c1">// .. do the watermarking and return it</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nf">watermark</span><span class="p">(</span><span class="n">image</span><span class="p">:</span> <span class="bp">UIImage</span><span class="p">,</span> <span class="n">using</span> <span class="n">algo</span><span class="p">:</span> <span class="p">(</span><span class="nb">String</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="bp">UIImage</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nv">result</span> <span class="p">=</span> <span class="n">algo</span><span class="p">(</span><span class="s">&quot;Alex&#39;s Photo&quot;</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>

<p>These are all valid calling syntaxes. Is there one which is more idiomatic or natural to Swift developers?</p>
<div class="highlight"><pre><span></span><code><span class="n">watermark</span><span class="p">(</span><span class="n">image</span><span class="p">:</span> <span class="n">myPhoto</span><span class="p">)</span> <span class="p">{</span> <span class="p">(</span><span class="n">watermarkText</span><span class="p">:</span> <span class="nb">String</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="bp">UIImage</span> <span class="k">in</span>
    <span class="k">return</span> <span class="n">cgContextWatermark</span><span class="p">(</span><span class="n">image</span><span class="p">:</span> <span class="n">myPhoto</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="n">watermarkText</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">watermark</span><span class="p">(</span><span class="n">image</span><span class="p">:</span> <span class="n">myPhoto</span><span class="p">)</span> <span class="p">{</span> <span class="p">(</span><span class="n">watermarkText</span><span class="p">:</span> <span class="nb">String</span><span class="p">)</span> <span class="k">in</span> 
    <span class="k">return</span> <span class="n">cgContextWatermark</span><span class="p">(</span><span class="n">image</span><span class="p">:</span> <span class="n">myPhoto</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="n">watermarkText</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">watermark</span><span class="p">(</span><span class="n">image</span><span class="p">:</span> <span class="n">myPhoto</span><span class="p">)</span> <span class="p">{</span> <span class="n">watermarkText</span> <span class="k">in</span> 
    <span class="k">return</span> <span class="n">cgContextWatermark</span><span class="p">(</span><span class="n">image</span><span class="p">:</span> <span class="n">myPhoto</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="n">watermarkText</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">watermark</span><span class="p">(</span><span class="n">image</span><span class="p">:</span> <span class="n">myPhoto</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">cgContextWatermark</span><span class="p">(</span><span class="n">image</span><span class="p">:</span> <span class="n">myPhoto</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nv">$0</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">watermark</span><span class="p">(</span><span class="n">image</span><span class="p">:</span> <span class="n">myPhoto</span><span class="p">)</span> <span class="p">{</span> <span class="n">cgContextWatermark</span><span class="p">(</span><span class="n">image</span><span class="p">:</span> <span class="n">myPhoto</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nv">$0</span><span class="p">)</span> <span class="p">}</span>
</code></pre></div>

<p>Who knew that syntaxes was the plural of syntax? Not this guy.</p>
<p>Also, you can return a closure from a function, which is pretty nifty:</p>
<div class="highlight"><pre><span></span><code><span class="kd">enum</span> <span class="nc">IdentificationTechnique</span> <span class="p">{</span>
    <span class="k">case</span> <span class="n">ComputerVision</span>
    <span class="k">case</span> <span class="n">Jepson</span>
    <span class="k">case</span> <span class="n">Intuition</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nf">createIdentifier</span><span class="p">(</span><span class="n">using</span> <span class="n">technique</span><span class="p">:</span> <span class="n">IdentificationTechnique</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="p">(</span><span class="bp">UIImage</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="nb">String</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">{</span> <span class="kc">_</span> <span class="k">in</span> 
        <span class="k">switch</span> <span class="n">technique</span> <span class="p">{</span>
        <span class="k">case</span> <span class="p">.</span><span class="n">ComputerVision</span><span class="p">:</span> 
            <span class="k">return</span> <span class="s">&quot;It&#39;s probably a Western Honey Bee.&quot;</span>
        <span class="k">case</span> <span class="p">.</span><span class="n">Jepson</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&quot;Let&#39;s key it out.&quot;</span>
        <span class="k">case</span> <span class="p">.</span><span class="n">Intuition</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&quot;Definitely a California Slender Salamander.&quot;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">let</span> <span class="nv">identifier</span> <span class="p">=</span> <span class="n">createIdentifier</span><span class="p">(</span><span class="n">using</span><span class="p">:</span> <span class="p">.</span><span class="n">ComputerVision</span><span class="p">)</span>
<span class="kd">let</span> <span class="nv">photo</span> <span class="p">=</span> <span class="p">...</span>
<span class="bp">print</span><span class="p">(</span><span class="n">identifier</span><span class="p">(</span><span class="n">photo</span><span class="p">))</span>
</code></pre></div>

<p>Finally, my daily annoyance. All the bloggers are whining about iPadOS needing an update, and I've mostly been ignoring it. The YouTuber/blogger echo chamber among the Mac/iOS technorati generates mostly garbage; I don't care about external USB access on my iPad, and I don't care if anyone agrees with me there. However, there are a few things that are annoying about split view. The safe area isn't correctly calculated by Playgrounds when in split view, and I've seen this in other apps, so I think it's not just a playgrounds problem. Also, how do I know which view has keyboard focus? When I tap <code>CMD-w</code> on my keyboard, will my playground page or the active safari tab be closed?</p>
</article>

        <footer>
            <nav>
                <ul>
                    <li>:: <a href="https://alexshepard.github.io/categories.html">Categories</a></li>
                    <li>:: <a href="https://alexshepard.github.io/tags.html">Tags</a></li>
                </ul>
            </nav>
                <p id="theme-credit"><a href="http://mathieu.agopian.info/mnmlist/theme.html">Th√®me mnmlist</a></p>
        </footer>

</body>
</html>